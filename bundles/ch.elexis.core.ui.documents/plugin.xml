<?xml version="1.0" encoding="UTF-8"?>
<?eclipse version="3.4"?>
<plugin>
   <extension
         point="org.eclipse.ui.views">
      <view
            category="ch.elexis.textKategorie"
            class="ch.elexis.core.ui.documents.views.DocumentsView"
            icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16//document_new.png"
            id="ch.elexis.core.ui.documents.views.DocumentsView"
            inject="true"
            name="%view.name">
      </view>
   </extension>
   <extension
         point="org.eclipse.ui.commands">
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentCrudHandler"
            id="ch.elexis.core.ui.documents.commandUpdate"
            name="%command.name">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentCrudHandler"
            id="ch.elexis.core.ui.documents.commandDelete"
            name="%command.name.0">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentCrudHandler"
            id="ch.elexis.core.ui.documents.commandCreate"
            name="%command.name.1">
      </command>
      <command
            id="ch.elexis.core.ui.documents.commandExport"
            name="%command.name.2">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentLocalEditHandler"
            id="ch.elexis.core.ui.documents.commandLocalEditStart"
            name="%command.name.3">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentLocalEditHandler"
            id="ch.elexis.core.ui.documents.commandLocalEditAbort"
            name="%command.name.4">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentLocalEditHandler"
            id="ch.elexis.core.ui.documents.commandLocalEditDone"
            name="%command.name.5">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DocumentLocalEditHandler"
            id="ch.elexis.core.ui.documents.commandLocalEditOverview"
            name="%command.name.6">
      </command>
      <command
            id="ch.elexis.core.ui.documents.commandSendAsMail"
            name="%command.name.7">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.DefaultDocumentSendHandler"
            id="ch.elexis.core.ui.documents.send"
            name="%command.name.8">
      </command>
      <command
            defaultHandler="ch.elexis.core.ui.documents.handler.FlatViewHandler"
            id="ch.elexis.core.ui.documents.commandFlatView"
            name="%command.name.9">
      </command>
      <command
            id="ch.elexis.core.ui.documents.commandSendToCancerRegister"
            name="Senden an Krebsregister">
      </command>
      <command
            id="ch.elexis.core.ui.documents.commandOpenSelection"
            name="Open Selection Dialog">
      </command>
   </extension>
   <extension
         point="org.eclipse.ui.menus">
      <menuContribution
            allPopups="false"
            locationURI="popup:ch.elexis.core.ui.documents.views.DocumentsView">
         <command
               commandId="ch.elexis.core.ui.documents.commandUpdate"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/edit.png"
               label="%command.label"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <instanceof
                        value="ch.elexis.core.model.IDocument">
                  </instanceof>
               </iterate>
            </visibleWhen>
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandDelete"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/delete.png"
               label="%command.label.0"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <iterate
                     ifEmpty="false"
                     operator="and">
                  <instanceof
                        value="ch.elexis.core.model.IDocument">
                  </instanceof>
               </iterate>
            </visibleWhen>
         </command>
         <separator
               name="ch.elexis.core.ui.documents.separator1"
               visible="true">
         </separator>
         <command
               commandId="ch.elexis.core.ui.documents.commandLocalEditStart"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/edit.png"
               label="%command.label.1"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <not>
                  <test
                  		forcePluginActivation="true"
                        property="ch.elexis.core.ui.documents.isExternFile">
                  </test>
               </not>
            </visibleWhen>
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandLocalEditDone"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/edit_done.png"
               label="%command.label.2"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <not>
                  <test
                  		forcePluginActivation="true"
                        property="ch.elexis.core.ui.documents.isExternFile">
                  </test>
               </not>
            </visibleWhen>
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandLocalEditAbort"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/edit_abort.png"
               label="%command.label.3"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <not>
                  <test
                  		forcePluginActivation="true"
                        property="ch.elexis.core.ui.documents.isExternFile">
                  </test>
               </not>
            </visibleWhen>
         </command>
         <separator
               name="ch.elexis.core.ui.documents.separator2"
               visible="true">
         </separator>
         <menu
               icon="icon://IMG_MAIL_SEND"
               label="%menu.label">
            <command
                  commandId="ch.elexis.core.ui.documents.commandSendAsMail"
                  label="%command.label.4"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <test
                        property="ch.elexis.core.mail.ui.sendavailable">
                  </test>
               </visibleWhen>
            </command>
            <command
                  commandId="ch.elexis.core.ui.documents.commandSendToCancerRegister"
                  label="an Krebsregister"
                  style="push">
               <visibleWhen
                     checkEnabled="false">
                  <with
                        variable="org.eclipse.ui.selection">
                     <count
                           value="1">
                     </count>
                     <iterate>
                        <test
                              args="pdf"
                              forcePluginActivation="true"
                              property="ch.elexis.core.ui.documents.isMimeType">
                        </test>
                     </iterate>
                  </with>
               </visibleWhen>
            </command>
         </menu>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="toolbar:ch.elexis.core.ui.documents.views.DocumentsView">
         <command
               commandId="ch.elexis.core.ui.documents.commandCreate"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/import.gif"
               label="%command.label.5"
               style="push"
               tooltip="%command.label.5">
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandExport"
               icon="platform:/plugin/ch.elexis.core.ui.icons/icons/16x16/export.ico"
               label="%command.label.6"
               style="push"
               tooltip="%command.label.6">
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandLocalEditOverview"
               icon="icon://IMG_EDIT"
               label="%command.label.7"
               style="push"
               tooltip="%command.tooltip">
            <visibleWhen
                  checkEnabled="false">
               <test
                     property="ch.elexis.core.ui.property.documenteditlocal">
               </test>
            </visibleWhen>
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.send"
               icon="icon://IMG_MAIL_SEND"
               label="%command.label.8"
               style="pulldown">
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandFlatView"
               icon="icon://IMG_FILTER/icon.png"
               label="%command.label.10"
               style="toggle">
         </command>
      </menuContribution>
      <menuContribution
            allPopups="false"
            locationURI="menu:ch.elexis.core.ui.documents.send">
         <command
               commandId="ch.elexis.core.ui.documents.commandSendAsMail"
               label="%command.label.9"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <test
                     property="ch.elexis.core.mail.ui.sendavailable">
               </test>
            </visibleWhen>
         </command>
         <command
               commandId="ch.elexis.core.ui.documents.commandSendToCancerRegister"
               label="an Krebsregister"
               style="push">
            <visibleWhen
                  checkEnabled="false">
               <with
                     variable="org.eclipse.ui.selection">
                  <count
                        value="1">
                  </count>
                  <iterate>
                     <test
                           args="pdf"
                           forcePluginActivation="true"
                           property="ch.elexis.core.ui.documents.isMimeType">
                     </test>
                  </iterate>
               </with>
            </visibleWhen>
         </command>
      </menuContribution>
   </extension>
   <extension
         point="org.eclipse.ui.handlers">
      <handler
            class="ch.elexis.core.ui.documents.handler.DocumentExportHandler"
            commandId="ch.elexis.core.ui.documents.commandExport">
      </handler>
      <handler
            class="ch.elexis.core.ui.documents.handler.DocumentSendAsMailHandler"
            commandId="ch.elexis.core.ui.documents.commandSendAsMail">
      </handler>
      <handler
            class="ch.elexis.core.ui.documents.handler.DocumentSendToCancerRegister"
            commandId="ch.elexis.core.ui.documents.commandSendToCancerRegister">
      </handler>
      <handler
            class="ch.elexis.core.ui.documents.handler.OpenSelectionHandler"
            commandId="ch.elexis.core.ui.documents.commandOpenSelection">
      </handler>
   </extension>
   <extension
         point="org.eclipse.core.expressions.propertyTesters">
      <propertyTester
            class="ch.elexis.core.ui.documents.tester.DocumentsPropertyTester"
            id="ch.elexis.core.ui.documents.propertyTester"
            namespace="ch.elexis.core.ui.documents"
            properties="isMimeType,isExternFile"
            type="java.lang.Object">
      </propertyTester>
   </extension>

</plugin>
